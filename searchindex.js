Search.setIndex({"docnames": ["01-intro", "02-frame", "03-approach", "04-bellman", "05-bellman-optimal", "06-dynamic", "07-monte-carlo-td", "08-q-learning", "09-deep-q-learning", "10-dqn-torch", "11-policy", "12-actor-critic", "13-trpo", "14-gae", "15-ppo", "17-ppo-trl"], "filenames": ["01-intro.ipynb", "02-frame.ipynb", "03-approach.ipynb", "04-bellman.ipynb", "05-bellman-optimal.ipynb", "06-dynamic.ipynb", "07-monte-carlo-td.ipynb", "08-q-learning.ipynb", "09-deep-q-learning.ipynb", "10-dqn-torch.ipynb", "11-policy.ipynb", "12-actor-critic.ipynb", "13-trpo.ipynb", "14-gae.ipynb", "15-ppo.ipynb", "17-ppo-trl.ipynb"], "titles": ["What is Reinforcement Learning?", "The Reinforcement Learning Framework", "Two main approaches for solving RL problems", "The Bellman Equation", "The Bellman Optimality Equation", "Dynamic Programming", "Monte Carlo vs Temporal Difference Learning", "Q-learning", "Deep Q-Learning", "Deep Q-Learning with Pytorch", "Policy Gradient", "Actor-Critic Methods", "TRPO", "Generalized Advantage Estimation", "Proximal Policy Optimization", "Reinforcement Learning From Human Feedback"], "terms": {"To": [0, 1, 8, 10, 11, 12, 14, 15], "understand": [0, 1, 5, 11, 14], "let": [0, 1, 3, 4, 5, 8, 11, 12, 13, 14], "s": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14], "start": [0, 1, 2, 3, 4, 9, 10, 11], "idea": [0, 5, 6, 7, 8, 10, 11, 14], "behind": [0, 5, 11], "an": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "agent": [0, 1, 6, 7, 8, 9, 10, 11, 14], "ai": 0, "from": [0, 1, 3, 8, 9, 10, 11, 12, 14], "environ": [0, 1, 5, 8, 9, 10, 11], "interact": [0, 6, 7, 8], "through": [0, 1, 5, 11], "trial": 0, "error": [0, 8, 9, 10, 11, 14, 15], "receiv": [0, 1], "reward": [0, 2, 3, 7, 8, 9, 10, 11, 12, 13, 14], "neg": 0, "posit": [0, 1, 8], "feedback": [0, 11], "perform": [0, 7, 8, 9, 10, 11, 12], "action": [0, 5, 7, 8, 9, 10, 11, 12, 13, 14], "come": [0, 1, 2, 10, 14, 15], "our": [0, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "natur": [0, 10], "experi": [0, 6, 7], "For": [0, 2, 4, 5, 10], "instanc": [0, 10], "imagin": [0, 1, 11], "put": 0, "your": [0, 8, 11], "littl": 0, "brother": 0, "front": 0, "video": [0, 1, 11], "game": [0, 1, 11], "he": 0, "never": 0, "plai": [0, 1, 6, 11], "give": [0, 1, 4, 8, 12, 14], "him": 0, "control": [0, 9, 11, 13, 15], "leav": 0, "alon": 0, "press": 0, "right": [0, 1, 2, 3, 4, 5, 7, 9, 10, 11, 12, 13, 14, 15], "button": 0, "got": 0, "coin": 0, "1": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "It": [0, 1, 4, 5, 6, 8, 9, 10, 11, 12], "just": [0, 1, 5, 13], "understood": 0, "thi": [0, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15], "must": [0, 4, 5, 7, 13], "get": [0, 1, 2, 3, 7, 8, 9, 10, 11, 15], "But": [0, 1, 6, 7, 10], "again": [0, 1, 5], "touch": 0, "enemi": 0, "di": 0, "so": [0, 1, 2, 3, 5, 6, 7, 9, 10, 11, 14], "By": [0, 6, 7, 8, 9, 14, 15], "hi": 0, "need": [0, 2, 3, 7, 9, 10, 11, 14, 15], "avoid": [0, 8, 14], "without": [0, 5, 10, 11, 14, 15], "ani": [0, 3, 4, 5, 7, 10, 12, 15], "supervis": [0, 15], "child": 0, "better": [0, 1, 5, 6, 7, 8, 10, 11], "That": 0, "how": [0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 14], "human": 0, "anim": 0, "comput": [0, 5, 7, 8, 9, 10, 11, 12, 14], "approach": [0, 8], "we": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "can": [0, 1, 2, 3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15], "now": [0, 1, 2, 3, 4, 10, 11, 12, 15], "make": [0, 1, 5, 7, 8, 9, 10, 11, 12, 13, 15], "framework": [0, 2], "solv": [0, 7, 10, 11, 12], "task": [0, 7], "also": [0, 3, 8, 9, 10, 11, 12, 15], "call": [0, 3, 4, 5, 6, 7, 9, 10, 14], "decis": [0, 1, 5, 12], "problem": [0, 8, 10, 12, 13, 14], "build": [0, 2], "uniqu": [0, 3, 4], "doe": [0, 4, 7, 10, 12, 13], "work": [0, 3, 11, 14], "platform": 1, "s_": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "0": [1, 2, 4, 5, 9, 10, 11, 12, 13, 14, 15], "first": [1, 5, 9, 12, 13], "frame": 1, "base": [1, 9, 10, 11, 14, 15], "take": [1, 2, 3, 5, 8, 9, 10, 11, 12, 14], "a_": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "move": [1, 8, 9], "goe": [1, 7, 10], "new": [1, 5, 8, 9, 11, 12, 14], "some": [1, 4, 5, 10, 11, 12, 13, 15], "r_": [1, 2, 3, 4, 5, 6, 7, 8, 10, 11, 13, 14], "re": [1, 8, 9, 10, 11], "dead": 1, "loop": 1, "output": [1, 2, 8, 9, 10, 11, 15], "sequenc": [1, 4, 5, 8, 12, 15], "next": [1, 3, 6, 7, 8, 9, 11, 12, 13, 15], "tau": [1, 9, 10, 11, 14, 15], "s_0": [1, 12, 13], "a_0": [1, 12, 13], "r_1": 1, "s_1": [1, 8, 12], "a_1": [1, 12], "r_2": 1, "s_2": [1, 12], "a_2": 1, "dot": [1, 4, 5, 10, 11, 12, 13, 15], "why": [1, 4, 15], "goal": [1, 2, 4, 8], "maxim": [1, 2, 4, 7, 10, 12, 14, 15], "expect": [1, 2, 3, 4, 9, 10, 11, 12], "becaus": [1, 4, 5, 6, 8, 10, 11, 14, 15], "which": [1, 2, 4, 5, 8, 9, 10, 11, 12, 13, 14, 15], "all": [1, 2, 3, 4, 5, 9, 10, 11, 12, 15], "describ": [1, 9, 10, 12], "cumul": [1, 2, 10, 11], "ar": [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "inform": [1, 8], "In": [1, 2, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15], "case": [1, 2, 4, 5, 9, 13, 14, 15], "screenshot": 1, "trade": [1, 7], "valu": [1, 7, 8, 9, 10, 11, 12, 13, 14], "certain": 1, "stock": 1, "etc": 1, "There": [1, 2, 10, 13], "differenti": [1, 10, 12], "between": [1, 4, 8, 9, 12, 13, 14, 15], "howev": [1, 2, 8, 10, 11, 12, 13, 14], "complet": [1, 4, 5, 6, 8, 9, 15], "descript": 1, "world": 1, "hidden": 1, "chess": 1, "have": [1, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15], "access": 1, "whole": 1, "board": 1, "other": [1, 2, 3, 6, 7, 11], "word": [1, 2], "fulli": 1, "o": 1, "partial": [1, 4], "super": [1, 9, 10, 11], "mario": 1, "bro": 1, "onli": [1, 5, 6, 7, 10, 11, 13], "see": [1, 2, 4, 10, 11, 14], "part": [1, 6, 15], "level": [1, 15], "close": [1, 12, 13], "player": 1, "cours": [1, 10, 15], "us": [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "term": [1, 3, 5, 7, 10, 12, 13, 15], "denot": [1, 2, 5, 12, 14], "both": [1, 4, 5, 6, 8, 10, 11, 13, 15], "distinct": 1, "implement": [1, 8, 9, 10, 11], "set": [1, 9, 12, 13, 14, 15], "possibl": [1, 2, 8, 10, 11, 12, 13], "discret": 1, "continu": [1, 10], "number": [1, 9, 10, 11, 12, 13], "finit": [1, 12], "sinc": [1, 3, 4, 7, 10, 11, 13, 14], "4": [1, 5, 7, 9, 10, 11, 12], "direct": [1, 10, 11], "infinit": [1, 10, 11, 12], "A": [1, 2, 3, 4, 10, 11, 12, 13, 14, 15], "self": [1, 9, 10, 11, 15], "drive": 1, "car": 1, "ha": [1, 3, 4, 5, 8, 9, 10, 12, 13, 15], "turn": [1, 5, 10], "left": [1, 2, 3, 4, 5, 7, 9, 10, 11, 12, 13, 14, 15], "20": [1, 10, 11], "21": 1, "2": [1, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14], "function": [1, 4, 5, 6, 7, 8, 9, 10, 11, 12], "r": [1, 3, 4, 5, 10, 11, 12, 14, 15], "critic": [1, 14], "import": [1, 5, 9, 10, 11, 12, 15], "depend": [1, 7, 8, 10, 12], "current": [1, 2, 7, 8, 9, 10, 11, 12, 14, 15], "taken": [1, 9, 10, 11, 14], "t": [1, 2, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 15], "although": 1, "frequent": [1, 10], "simplifi": [1, 3], "pair": [1, 2, 3, 5, 7, 8, 9, 11, 15], "s_t": [1, 7, 8, 9, 10, 11, 12, 13, 15], "a_t": [1, 7, 10, 12, 13, 15], "notion": [1, 13], "over": [1, 5, 9, 10, 11, 12, 13, 15], "trajectori": [1, 10, 11, 12, 13, 14], "actual": [1, 8], "mean": [1, 9, 10, 11, 14], "few": [1, 8, 15], "thing": 1, "ll": [1, 6, 7, 9, 10, 11, 14], "notat": [1, 13], "either": [1, 9, 14], "clear": [1, 4], "context": 1, "won": 1, "matter": 1, "same": [1, 5, 7, 8, 10, 11, 15], "equat": [1, 2, 5, 7, 12], "appli": [1, 4], "One": [1, 5, 12], "kind": 1, "horizon": [1, 12], "undiscount": [1, 13], "sum": [1, 2, 4, 10, 11, 12, 13, 15], "obtain": [1, 4, 5, 9, 10, 11, 12, 13], "fix": [1, 5, 11, 15], "window": 1, "step": [1, 2, 5, 7, 8, 10, 11, 12, 13, 14, 15], "sum_": [1, 2, 3, 4, 5, 10, 11, 12, 13, 14, 15], "r_t": [1, 13], "anoth": [1, 5, 12], "discount": [1, 3, 4, 6, 7, 9, 11, 12, 13], "ever": [1, 10], "far": [1, 3, 5, 9, 10, 14, 15], "off": 1, "futur": 1, "thei": [1, 5, 7, 10, 12], "formul": [1, 10, 13], "includ": [1, 7], "factor": [1, 9, 12, 13], "gamma": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15], "infti": [1, 2, 4, 5, 12, 13, 15], "would": [1, 5, 9, 12, 14], "want": [1, 2, 8, 10, 11], "though": [1, 13], "don": [1, 6, 8, 11, 15], "do": [1, 2, 3, 7, 8, 10, 12, 14, 15], "intuit": [1, 10], "appeal": 1, "mathemat": [1, 15], "conveni": 1, "On": [1, 4, 6, 10, 11], "cash": 1, "than": [1, 3, 5, 8, 9, 10, 12, 14], "later": [1, 9], "mai": [1, 2, 5, 10, 13], "converg": [1, 5, 7, 10, 12], "hard": 1, "deal": 1, "under": [1, 2], "reason": [1, 5], "condit": [1, 10], "ve": [1, 9], "discuss": 1, "wai": [1, 5, 10, 11, 12, 14], "you": [1, 3, 8, 9, 11, 15], "try": [1, 7, 8, 11], "go": [1, 9, 10, 14, 15], "dig": 1, "literatur": [1, 5], "like": [1, 2, 3, 5, 8, 9, 10, 14], "run": [1, 6, 10, 11, 14, 15], "standard": 1, "markov": [1, 5, 12], "mdp": [1, 5, 12, 13], "5": [1, 2], "tupl": [1, 8, 9, 11, 12], "langl": 1, "p": [1, 3, 4, 5, 10, 12], "rho_0": [1, 12], "rangl": 1, "where": [1, 2, 4, 5, 9, 10, 11, 12, 13, 14], "valid": [1, 10], "time": [1, 2, 3, 7, 8, 10, 11, 12], "mathbb": [1, 2, 3, 4, 5, 7, 10, 12, 13, 14, 15], "mathcal": [1, 3, 4, 5, 8, 12, 14], "transit": [1, 8, 9, 12], "probabl": [1, 5, 7, 8, 10, 11, 12, 14, 15], "being": [1, 9, 11], "distribut": [1, 10, 11, 12], "name": [1, 9], "refer": [1, 5, 13], "fact": [1, 5, 13], "system": [1, 5, 15], "obei": 1, "properti": [1, 10], "most": [1, 5, 7, 10], "recent": [1, 9, 10], "prior": 1, "histori": 1, "learn": [2, 3, 4, 5, 10, 11, 14], "select": [2, 4, 7, 8, 9, 10, 11, 14], "its": [2, 4, 5, 6, 7, 10, 11, 12, 14], "tell": [2, 10], "what": [2, 3, 4, 7, 8, 10, 11, 14, 15], "given": [2, 5, 7, 8, 10, 11, 14], "defin": [2, 4, 9, 10, 12, 13, 15], "behavior": [2, 7], "find": [2, 3, 5, 7, 9, 10, 11], "optim": [2, 5, 7, 8, 9, 10, 11, 13], "ast": [2, 4, 5, 10], "return": [2, 3, 4, 8, 9, 10, 11, 12, 15], "when": [2, 5, 7, 8, 9, 13], "act": [2, 9, 10, 11], "accord": [2, 3, 9, 10], "train": [2, 6, 7, 8, 10, 11, 14], "directli": [2, 7, 8, 10, 11, 12, 14, 15], "teach": 2, "indirectli": 2, "more": [2, 6, 7, 8, 9, 10, 13, 14], "valuabl": 2, "lead": [2, 4, 8, 10, 11, 14], "determinist": [2, 4, 5], "usual": [2, 10, 14], "mu": [2, 10], "stochast": [2, 5, 7, 10, 11, 12, 15], "sim": [2, 10, 12, 14, 15], "cdot": [2, 4, 12], "instead": [2, 3, 6, 8, 10, 11, 12], "write": 2, "v_": [2, 3, 4, 5, 10, 12, 13, 14, 15], "e": [2, 3, 4, 5, 7, 10, 12, 13, 14, 15], "_": [2, 3, 4, 5, 9, 10, 11, 12, 13, 14, 15], "g_": [2, 6], "k": [2, 5, 10, 13, 14, 15], "each": [2, 3, 5, 8, 9, 10, 11, 14, 15], "follow": [2, 3, 4, 10, 12, 13, 15], "forev": [2, 3], "afterward": 2, "here": [2, 9, 13, 14, 15], "thank": [2, 11], "biggest": 2, "7": 2, "6": [2, 10], "attain": 2, "after": [2, 3, 5, 7, 9, 10, 15], "q_": [2, 3, 4, 5, 8, 12, 13], "whichev": 2, "choos": [2, 5, 7, 9], "calcul": [2, 3, 6, 8, 10, 11, 15], "computation": [2, 10], "expens": [2, 5, 10], "process": [2, 5, 7, 12, 14, 15], "bellman": [2, 5, 7], "help": [2, 5, 8, 10, 11], "pi": [3, 4, 5, 7, 10, 12, 13, 14, 15], "With": [3, 7, 8, 10, 14, 15], "know": [3, 5, 8, 10, 11], "polici": [3, 9, 11, 13], "dynam": 3, "program": 3, "veri": [3, 7, 9, 11, 12], "similar": 3, "recurs": 3, "begin": [3, 4, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15], "consid": [3, 4, 5, 12, 13, 15], "immedi": [3, 7, 10], "express": [3, 7, 10, 12, 13], "matrix": [3, 4], "p_": [3, 4, 10, 12], "proof": [3, 4, 5, 10], "i": [3, 4, 5, 8, 10, 11, 12, 13, 14, 15], "invert": 3, "n": [3, 4, 8, 9, 12, 13], "entri": [3, 4], "ij": 3, "r_i": 3, "j": [3, 10, 15], "ne": [3, 5], "d": [3, 4, 8, 12, 14], "ii": 3, "disc": 3, "center": [3, 9], "radiu": 3, "Such": 3, "Then": [3, 4, 5, 9, 10, 12], "everi": [3, 7, 8, 9, 11, 12], "eigenvalu": 3, "li": 3, "within": [3, 15], "least": 3, "one": [3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15], "lambda": [3, 9, 13, 15], "correspond": [3, 4, 13, 14], "eigenvector": 3, "x": [3, 4, 9, 10, 11, 15], "element": [3, 4, 9], "largest": [3, 9, 12], "absolut": [3, 4, 9], "x_": [3, 4], "ax": [3, 9], "particular": [3, 4], "th": [3, 4], "compon": 3, "x_j": 3, "side": [3, 5, 10], "therefor": [3, 4, 5, 8, 14], "frac": [3, 9, 10, 11, 12, 13, 14, 15], "x_i": 3, "le": [3, 4, 5, 9, 12], "s_i": 3, "equal": [3, 4, 12], "s_j": 3, "less": [3, 5, 7, 14], "magnitud": 3, "encircl": 3, "origin": [3, 5], "henc": [3, 12], "zero": [3, 9], "ultim": 4, "reinforc": [4, 5, 7, 14], "seek": [4, 12], "necessari": 4, "order": [4, 12], "pi_": [4, 5, 10, 11, 12, 13, 14, 15], "ge": [4, 5, 12, 14], "leftrightarrow": 4, "pi_1": 4, "pi_2": 4, "quad": [4, 8, 9, 12, 14], "foral": 4, "compar": [4, 7, 8, 11], "state": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14], "v": [4, 6, 9, 10, 11, 13, 15], "show": [4, 9, 10, 12], "maximum": [4, 8, 10], "achiev": [4, 5], "max_": [4, 5, 7, 8, 9, 10, 12, 14], "whose": 4, "out": [4, 10], "simultan": 4, "definit": [4, 9, 13], "mani": [4, 11, 15], "question": 4, "exist": [4, 6, 7, 8], "Is": 4, "algorithm": [4, 5, 11, 12], "align": [4, 5, 10, 12, 13, 15], "underset": [4, 10, 12, 14], "max": [4, 9, 12, 15], "end": [4, 5, 8, 9, 10, 12, 13, 14, 15], "f": [4, 9, 10, 11], "unknown": [4, 5], "variabl": [4, 10, 14], "metric": [4, 15], "space": [4, 8, 9, 10, 11, 12], "q": [4, 6, 10, 11, 12, 15], "tx": 4, "ty": 4, "qd": 4, "y": [4, 15], "non": [4, 8, 9, 14], "empti": 4, "admit": 4, "furthermor": 4, "found": [4, 9], "arbitrari": [4, 5], "lim_": 4, "omit": 4, "hold": [4, 9, 12], "rate": [4, 9, 15], "norm": 4, "vector": [4, 12], "two": [4, 6, 7, 8, 9, 10, 11, 13, 14, 15], "suppos": [4, 5, 10], "arg": [4, 5, 8, 9, 10, 12, 14], "split": [4, 15], "elementwis": 4, "comparison": 4, "As": [4, 9, 14, 15], "result": [4, 9, 10, 11, 15], "similarli": 4, "shown": [4, 5], "z": 4, "hand": [4, 6, 11], "z_": 4, "row": [4, 9], "nonneg": [4, 12], "alwai": [4, 9, 10], "solut": [4, 5, 8, 10, 11], "onc": [4, 5, 9], "been": [4, 5, 9], "easili": 4, "repeat": 4, "abov": [4, 12, 13, 15], "inequ": [4, 5], "last": [4, 10, 11, 15], "true": [4, 9, 10, 11, 12, 15], "studi": [4, 10, 11, 14], "easi": [4, 5, 14], "relat": [4, 13], "text": [4, 7, 9, 12, 13, 14, 15], "greedi": [4, 5, 7], "otherwis": [4, 7, 8, 9, 10, 13], "while": [4, 7, 8, 10, 11, 12, 14], "greatest": 4, "The": [5, 6, 9, 12, 13, 15], "dp": 5, "collect": [5, 9, 10, 11, 12, 14, 15], "perfect": 5, "model": [5, 9], "classic": 5, "limit": 5, "util": [5, 10], "assumpt": 5, "great": 5, "still": [5, 14], "theoret": 5, "provid": [5, 11, 12, 15], "essenti": [5, 9], "foundat": 5, "method": [5, 8, 9, 13, 14, 15], "present": 5, "rest": [5, 10], "book": 5, "view": [5, 9], "attempt": 5, "much": [5, 10, 13, 14], "effect": [5, 10, 13], "assum": [5, 12], "recal": [5, 7, 10], "If": [5, 8, 10, 11, 12, 14, 15], "known": [5, 13], "linear": [5, 8, 9, 10, 11], "principl": 5, "straightforward": 5, "purpos": 5, "suitabl": 5, "initi": [5, 7, 8, 9, 12, 14], "approxim": [5, 7, 8, 10, 11, 12, 13], "chosen": 5, "arbitrarili": [5, 10], "success": 5, "clearli": 5, "point": [5, 12], "updat": [5, 6, 7, 8, 9, 10, 11, 12, 14, 15], "rule": [5, 15], "inde": 5, "gener": [5, 7, 8, 10, 12, 15], "determin": [5, 9], "whether": 5, "should": [5, 10, 15], "chang": [5, 8, 10, 14], "good": [5, 10, 11], "keep": 5, "expand": [5, 12], "reappli": 5, "3": [5, 7, 13], "vdot": 5, "respect": [5, 8], "old": [5, 12, 14], "satisfi": [5, 12], "special": [5, 7, 12, 13], "specifi": 5, "carri": 5, "yield": [5, 13, 15], "even": 5, "thu": [5, 12], "monoton": 5, "overset": [5, 7], "longrightarrow": [5, 7], "guarante": 5, "strict": 5, "previou": [5, 8, 9, 10, 12, 13, 14], "unless": 5, "alreadi": 5, "drawback": 5, "involv": [5, 7, 10], "itself": 5, "truncat": [5, 9], "sever": [5, 13], "lose": 5, "stop": 5, "written": 5, "particularli": 5, "simpl": [5, 8, 15], "oper": [5, 10], "combin": [5, 7, 8, 9, 10, 11, 14, 15], "note": [5, 12, 13, 15], "simpli": 5, "strategi": [6, 7], "entir": 6, "befor": [6, 10, 13], "explain": [6, 15], "them": [6, 9, 10, 15], "exampl": [6, 15], "wait": [6, 9], "until": [6, 12], "target": [6, 7, 9, 11], "requir": [6, 7, 10, 11, 13, 15], "form": [6, 13], "td": [6, 7, 8, 11, 13, 15], "didn": 6, "estim": [6, 7, 8, 9, 10, 11, 14, 15], "ad": [6, 9], "bootstrap": [6, 8], "sampl": [6, 7, 8, 9, 10, 11, 13], "longleftarrow": 6, "alpha": [6, 10, 12, 15], "sarsa": [6, 7], "improv": [7, 13, 14], "contrast": 7, "tabl": [7, 8], "epsilon": [7, 8, 9, 12, 14, 15], "handl": 7, "explor": [7, 8], "exploit": 7, "highest": [7, 8], "random": [7, 8, 9, 10, 15], "At": [7, 8, 9, 11, 15], "huge": 7, "high": [7, 10, 11, 13, 14, 15], "consequ": [7, 8, 9, 10, 11, 14], "progress": 7, "reduc": [7, 8, 10, 13], "rememb": [7, 8, 14], "produc": [7, 11, 13], "plu": 7, "constantli": 7, "differ": [7, 8, 9, 10, 11, 12, 13, 14, 15], "iter": [7, 12], "illustr": 7, "below": [7, 9], "enviro": [7, 14], "tabular": 8, "becom": [8, 13], "small": [8, 9, 10, 12, 14], "enough": 8, "repres": [8, 9, 13], "effici": [8, 11], "arrai": [8, 9, 10, 11], "gigant": 8, "best": [8, 9], "parametr": 8, "theta": [8, 10, 11, 12, 13, 14, 15], "neural": [8, 9, 10, 13], "network": [8, 13], "done": [8, 9, 10, 11, 15], "creat": [8, 11], "loss": [8, 9, 11, 12], "predict": [8, 10, 15], "gradient": [8, 9, 11, 13, 14], "descent": [8, 10], "weight": [8, 9, 10, 13], "memori": 8, "capac": [8, 9], "episod": [8, 9, 13], "m": [8, 10, 11], "initialis": 8, "execut": [8, 9], "emul": 8, "observ": [8, 9, 11], "store": [8, 9, 15], "minibatch": [8, 14], "y_": [8, 15], "y_i": 8, "c": [8, 12], "reset": [8, 9, 10, 11], "phase": 8, "batch": [8, 9, 11, 13, 15], "randomli": [8, 11], "might": [8, 10], "suffer": 8, "instabl": 8, "mainli": 8, "stabil": [8, 9, 11, 14], "dure": [8, 9, 15], "buffer": [8, 9, 11], "save": [8, 9, 10, 11, 15], "reus": 8, "allow": [8, 10, 12, 13, 14], "multipl": [8, 10, 14], "forget": 8, "correl": 8, "sequenti": 8, "tend": 8, "remov": [8, 14], "oscil": 8, "diverg": [8, 12, 14, 15], "catastroph": 8, "aka": 8, "paramet": [8, 9, 10, 11, 12, 13, 14, 15], "signific": [8, 11, 14], "shift": 8, "closer": 8, "chase": 8, "were": 8, "cowboi": 8, "catch": 8, "cow": 8, "separ": 8, "copi": 8, "look": 8, "further": [8, 11], "speed": [8, 15], "up": [8, 9, 10, 11], "face": 8, "sure": [8, 15], "accuraci": [8, 13], "tri": 8, "neighbor": 8, "about": [8, 10, 14], "noisi": [8, 9], "fals": [8, 9, 15], "regularli": 8, "higher": [8, 9, 14], "complic": 8, "decoupl": 8, "section": [9, 12, 13, 14], "dqn": 9, "cartpol": [9, 10, 11], "v1": [9, 10, 11], "gymnasium": 9, "decid": 9, "cart": [9, 11], "pole": [9, 11], "attach": [9, 10], "stai": 9, "upright": 9, "indic": [9, 14], "increment": 9, "timestep": [9, 11, 12], "termin": [9, 10], "fall": 9, "too": [9, 14, 15], "unit": 9, "awai": [9, 14], "instal": 9, "pip": 9, "math": [9, 10], "matplotlib": 9, "pyplot": 9, "plt": 9, "namedtupl": [9, 11], "dequ": [9, 10], "itertool": [9, 10, 11], "count": [9, 10, 11], "gym": [9, 10, 11], "torch": [9, 10, 11, 15], "nn": [9, 10, 11], "env": 9, "is_ipython": 9, "inlin": 9, "get_backend": 9, "ipython": 9, "displai": 9, "ion": 9, "gpu": 9, "devic": 9, "cuda": 9, "is_avail": 9, "els": [9, 15], "cpu": 9, "class": [9, 10, 11], "singl": [9, 12, 15], "map": [9, 15], "next_stat": 9, "screen": 9, "imag": 9, "replaymemori": 9, "cyclic": 9, "bound": [9, 12], "size": [9, 11, 12, 14], "object": [9, 10, 12, 15], "def": [9, 10, 11, 15], "__init__": [9, 10, 11], "maxlen": 9, "push": [9, 10, 11, 14], "append": [9, 10, 11, 15], "batch_siz": 9, "__len__": 9, "len": 9, "feed": 9, "forward": [9, 10, 11], "patch": 9, "input": [9, 11], "modul": [9, 10, 11], "n_observ": 9, "n_action": 9, "layer1": 9, "128": [9, 10, 11], "layer2": 9, "layer3": 9, "tensor": [9, 10, 11, 15], "left0exp": 9, "right0exp": 9, "relu": [9, 10, 11], "mention": [9, 15], "eps_start": 9, "eps_end": 9, "final": 9, "eps_decai": 9, "exponenti": [9, 13], "decai": 9, "slower": [9, 10], "lr": [9, 10, 11, 15], "adamw": [9, 15], "99": [9, 10, 11], "9": 9, "05": [9, 10, 11], "1000": 9, "005": 9, "1e": [9, 10], "action_spac": 9, "info": 9, "policy_net": 9, "target_net": 9, "load_state_dict": 9, "state_dict": 9, "amsgrad": 9, "10000": [9, 10, 11], "steps_don": 9, "select_act": [9, 10, 11], "global": [9, 10], "eps_threshold": 9, "exp": 9, "no_grad": [9, 15], "column": [9, 15], "second": [9, 13], "index": [9, 13], "wa": [9, 10, 14], "pick": 9, "larger": [9, 12], "dtype": [9, 10, 11], "long": 9, "episode_dur": 9, "plot_dur": 9, "show_result": 9, "figur": 9, "durations_t": 9, "float": [9, 10, 11, 15], "titl": 9, "clf": 9, "xlabel": 9, "ylabel": 9, "durat": 9, "plot": 9, "numpi": [9, 10, 11], "100": [9, 10, 11], "averag": [9, 10, 11, 12, 13], "unfold": 9, "cat": [9, 10], "paus": 9, "001": 9, "bit": 9, "gcf": 9, "clear_output": 9, "optimize_model": 9, "concaten": 9, "soft": 9, "previous": 9, "huber": 9, "squar": [9, 10, 14], "larg": [9, 11, 12, 13, 14, 15], "robust": [9, 12], "outlier": 9, "l": [9, 13, 14, 15], "delta": [9, 11, 12, 15], "convert": 9, "zip": [9, 10, 11, 15], "mask": [9, 15], "simul": [9, 12], "non_final_mask": 9, "none": [9, 15], "bool": [9, 10], "non_final_next_st": 9, "state_batch": 9, "action_batch": 9, "reward_batch": 9, "These": 9, "state_action_valu": 9, "gather": 9, "older": [9, 14, 15], "merg": 9, "next_state_valu": 9, "expected_state_action_valu": 9, "criterion": 9, "smoothl1loss": 9, "unsqueez": [9, 10], "zero_grad": [9, 10, 11], "backward": [9, 10, 11, 15], "place": [9, 13], "clip": [9, 15], "clip_grad_value_": 9, "main": [9, 13, 15], "fail": 9, "restart": 9, "num_episod": 9, "600": 9, "i_episod": [9, 10, 11], "rang": [9, 10, 11, 13, 14, 15], "float32": [9, 10, 11], "item": [9, 10, 11], "\u03b8": 9, "\u03c4": 9, "target_net_state_dict": 9, "policy_net_state_dict": 9, "kei": 9, "break": [9, 10, 11, 15], "print": [9, 10, 11], "ioff": 9, "432x288": 9, "intermedi": 10, "toward": 10, "parameter": [10, 15], "ascent": [10, 14], "dimension": 10, "deep": [10, 15], "assign": 10, "score": [10, 11, 15], "aggress": 10, "dramat": [10, 14], "local": [10, 12], "optimum": 10, "longer": 10, "varianc": [10, 13, 15], "leftarrow": 10, "nabla": [10, 14, 15], "deriv": [10, 15], "fortun": [10, 11], "reformul": 10, "nabla_": [10, 11, 12, 13, 14, 15], "log": [10, 11, 13, 14, 15], "h": 10, "interpret": 10, "steepest": 10, "increas": [10, 11, 12], "down": 10, "examin": 10, "proport": 10, "doesn": 10, "sens": 10, "realli": 10, "basi": 10, "bear": 10, "lower": [10, 12, 13], "simplest": [10, 15], "claim": 10, "eglp": 10, "lemma": 10, "normal": 10, "int_": 10, "trick": 10, "b": [10, 13], "add": 10, "subtract": [10, 11], "common": 10, "choic": [10, 13], "life": 10, "empir": 10, "desir": 10, "faster": [10, 11], "stabl": [10, 13], "practic": [10, 12, 13], "cannot": 10, "exactli": [10, 12], "phi": [10, 14, 15], "concurr": 10, "minim": 10, "phi_": [10, 14, 15], "min": [10, 14], "hat": [10, 11, 13, 14, 15], "pi_k": 10, "epoch": [10, 15], "seen": [10, 14], "phi_t": 10, "could": [10, 12], "despit": [10, 13], "wors": 10, "rel": [10, 11], "mlp": 10, "affine1": [10, 11], "dropout": 10, "affine2": 10, "saved_log_prob": 10, "action_scor": 10, "softmax": [10, 11], "dim": [10, 11], "adam": [10, 11], "seed": [10, 11], "00118216": 10, "04504637": 10, "03558404": 10, "04486495": 10, "np": [10, 11, 15], "categor": [10, 11], "from_numpi": [10, 11], "prob": [10, 11], "log_prob": [10, 11], "finish_episod": [10, 11], "ep": [10, 11], "finfo": [10, 11], "policy_loss": [10, 11, 15], "appendleft": 10, "std": [10, 11], "del": [10, 11], "running_reward": [10, 11], "10": [10, 11], "ep_reward": [10, 11], "tlast": [10, 11], "2f": [10, 11], "taverag": [10, 11], "format": [10, 11], "spec": [10, 11], "reward_threshold": [10, 11], "user": [10, 15], "xiayunhui": 10, "anaconda3": 10, "lib": 10, "python3": 10, "11": [10, 11], "site": 10, "packag": 10, "passive_env_check": 10, "py": 10, "233": 10, "deprecationwarn": 10, "bool8": 10, "deprec": 10, "alia": 10, "bool_": 10, "24": 10, "isinst": 10, "45": 10, "00": [10, 11], "15": 10, "06": 10, "35": 10, "27": 10, "30": [10, 11], "98": 10, "40": [10, 11], "73": 10, "42": [10, 11], "89": 10, "50": [10, 11], "39": 10, "75": 10, "60": [10, 11], "92": 10, "66": 10, "16": 10, "70": [10, 11], "331": 10, "107": 10, "18": 10, "80": [10, 11], "103": 10, "154": 10, "36": 10, "90": [10, 11], "48": [10, 11], "113": 10, "81": 10, "96": 10, "110": [10, 11], "172": 10, "155": 10, "120": [10, 11], "239": [10, 11], "206": 10, "130": [10, 11], "196": 10, "224": 10, "19": [10, 11], "140": 10, "194": 10, "251": 10, "26": [10, 11], "150": 10, "372": 10, "160": 10, "305": 10, "362": 10, "52": 10, "649": 10, "4581415449471": 10, "5964": 10, "aim": [11, 15], "saw": 11, "well": 11, "mont": [11, 12], "carlo": [11, 12], "todai": [11, 14], "hybrid": [11, 14], "architectur": [11, 14, 15], "behav": 11, "measur": [11, 12], "proportion": 11, "decreas": 11, "unbias": 11, "vari": 11, "significantli": 11, "across": 11, "mitig": 11, "addit": [11, 15], "mechan": 11, "friend": 11, "assist": 11, "w": 11, "pass": [11, 15], "beta": [11, 15], "extra": 11, "beyond": 11, "opposit": 11, "layer": 11, "action_head": 11, "value_head": 11, "saved_act": 11, "chose": 11, "action_prob": 11, "evalu": [11, 12], "state_valu": 11, "list": 11, "3e": 11, "02383879": 11, "02015088": 11, "03142257": 11, "04080841": 11, "savedact": 11, "code": [11, 15], "backprop": 11, "value_loss": [11, 15], "insert": 11, "l1": 11, "smooth": 11, "smooth_l1_loss": 11, "stack": [11, 15], "9999": 11, "check": 11, "12": 11, "13": 11, "41": 11, "82": 11, "44": 11, "29": 11, "22": 11, "14": 11, "87": 11, "64": 11, "71": 11, "1857": 11, "195": 11, "173": 11, "51": 11, "179": 11, "164": 11, "31": 11, "178": 11, "815": 11, "4286146729273": 11, "constraint": [12, 14], "rho_": 12, "distriarbut": 12, "eta": 12, "ident": 12, "tild": 12, "advantag": [12, 14], "visit": 12, "frequenc": 12, "rewrit": 12, "impli": 12, "rho": 12, "complex": 12, "difficult": 12, "introduc": [12, 13, 15], "l_": 12, "rather": 12, "match": 12, "theta_": [12, 14, 15], "theta_0": [12, 15], "suffici": 12, "guidanc": 12, "big": 12, "address": [12, 13], "issu": 12, "author": [12, 15], "propos": 12, "scheme": 12, "explicit": 12, "total": [12, 13], "variat": 12, "d_": [12, 15], "tv": 12, "distanc": 12, "theorem": 12, "relationship": 12, "kl": 12, "cd_": 12, "exact": 12, "constrain": [12, 14], "type": 12, "minor": 12, "mm": 12, "trust": [12, 13], "region": [12, 13], "preced": 12, "penalti": 12, "coeffici": 12, "recommend": 12, "theori": 12, "subject": 12, "impos": 12, "motiv": 12, "impract": 12, "due": [12, 13, 15], "heurist": 12, "bar": 12, "theta_1": [12, 15], "theta_2": [12, 15], "replac": [12, 14], "contribut": 12, "s_n": 12, "equival": 12, "procedur": [12, 13], "challeng": 13, "typic": [13, 14], "difficulti": 13, "steadi": 13, "nonstationar": 13, "incom": 13, "data": [13, 15], "substanti": 13, "cost": 13, "bia": [13, 15], "g": [13, 14, 15], "psi_": 13, "baselin": 13, "version": 13, "formula": 13, "residu": 13, "almost": 13, "lowest": 13, "downweight": 13, "delai": 13, "treat": 13, "reduct": 13, "colon": 13, "inclus": 13, "proceed": 13, "verifi": 13, "_t": 13, "concern": 13, "accur": 13, "construct": 13, "delta_": [13, 15], "correct": 13, "bias": 13, "smaller": 13, "heavili": 13, "affect": 13, "gae": 13, "analog": 13, "wherea": 13, "notabl": 13, "regardless": 13, "induc": 13, "compromis": [13, 15], "actor": 14, "a2c": 14, "specif": [14, 15], "harm": 14, "slow": 14, "multipli": 14, "former": 14, "excess": 14, "penal": 14, "ensur": [14, 15], "minimum": 14, "situat": 14, "via": 14, "theta_k": 14, "sgd": 14, "hyperparamet": [14, 15], "roughli": 14, "sai": 14, "serv": 14, "regular": 14, "incent": 14, "profit": 14, "paramt": 14, "tau_": 14, "fit": 14, "regress": 14, "min_": 14, "trl": 15, "yunhui": 15, "xia": 15, "wei": 15, "shen": 15, "full": 15, "librari": 15, "tool": 15, "transform": 15, "languag": 15, "fine": 15, "tune": 15, "rm": 15, "proxim": 15, "integr": 15, "blog": 15, "three": 15, "support": 15, "signal": 15, "rl": 15, "handcraft": 15, "prefer": 15, "respons": 15, "queri": 15, "scalar": 15, "optimis": 15, "deviat": 15, "activ": 15, "contain": 15, "load_dataset": 15, "huggingfaceh4": 15, "cherry_picked_prompt": 15, "rename_column": 15, "prompt": 15, "remove_column": 15, "meta": 15, "subset": 15, "ppo_dataset_dict": 15, "moon": 15, "land": 15, "year": 15, "sentenc": 15, "aren": 15, "bird": 15, "real": 15, "happen": 15, "fire": 15, "cannonbal": 15, "pumpkin": 15, "steal": 15, "groceri": 15, "caught": 15, "eat": 15, "sock": 15, "medit": 15, "wish": 15, "addition": 15, "reward_model": 15, "ppoconfig": 15, "dataclass": 15, "config": 15, "model_nam": 15, "gpt2": 15, "learning_r": 15, "41e": 15, "automat": 15, "autotoken": 15, "automodelforcausallmwithvaluehead": 15, "from_pretrain": 15, "pad_token": 15, "eos_token": 15, "pretoken": 15, "input_id": 15, "encod": 15, "string": 15, "length": 15, "bleu": 15, "pipelin": 15, "classif": 15, "lvwerra": 15, "distilbert": 15, "imdb": 15, "readi": 15, "ppo_train": 15, "guid": 15, "generation_kwarg": 15, "min_length": 15, "top_k": 15, "top_p": 15, "do_sampl": 15, "pad_token_id": 15, "eos_token_id": 15, "tqdm": 15, "dataload": 15, "query_tensor": 15, "sftmodel": 15, "response_tensor": 15, "decod": 15, "squeez": 15, "pipe_output": 15, "stat": 15, "log_stat": 15, "save_model": 15, "my_ppo_model": 15, "ratio": 15, "rlhf": 15, "workflow": 15, "llm": 15, "y_1": 15, "y_t": 15, "all_logprob": 15, "logits_or_non": 15, "batched_forward_pass": 15, "model_input": 15, "response_mask": 15, "return_logit": 15, "full_kl_penalti": 15, "logit": 15, "input_kwarg": 15, "optional_peft_ctx": 15, "ref_logprob": 15, "ref_logits_or_non": 15, "is_peft_model": 15, "ref_model": 15, "compute_reward": 15, "floattensor": 15, "longtensor": 15, "non_score_reward": 15, "_kl_penalti": 15, "kl_ctl": 15, "clone": 15, "last_non_masked_index": 15, "nonzero": 15, "kl_penalti": 15, "delta_t": 15, "techniqu": 15, "revers": 15, "gen_len": 15, "nextvalu": 15, "lastgaelam": 15, "lam": 15, "advantages_revers": 15, "transpos": 15, "ppo_epoch": 15, "early_stop": 15, "b_ind": 15, "permut": 15, "bs": 15, "backward_batch_start": 15, "backward_batch_s": 15, "backward_batch_end": 15, "backward_batch_ind": 15, "mini_batch_start": 15, "mini_batch_s": 15, "newest": 15, "vpred": 15, "mini_batch_dict": 15, "pgloss": 15, "pg_loss": 15, "pg_losses2": 15, "clamp": 15, "cliprang": 15, "masked_mean": 15, "pg_clipfrac": 15, "gt": 15, "vfloss": 15, "vf_losses1": 15, "loss_p": 15, "loss_v": 15, "train_stat": 15, "old_logprob": 15, "acceler": 15, "max_grad_norm": 15, "sync_gradi": 15, "clip_grad_norm_": 15, "model_param": 15, "datait": 15, "max_step": 15, "batch_forward": 15, "all_advantag": 15, "all_return": 15, "compute_advantag": 15, "num_minibatch": 15, "minibatch_queri": 15, "minibatch_respons": 15, "satrt": 15, "http": 15, "huggingfac": 15, "co": 15, "doc": 15, "en": 15, "unit8": 15, "arxiv": 15, "org": 15, "ab": 15, "1506": 15, "02438": 15, "spinningup": 15, "openai": 15, "com": 15, "latest": 15, "html": 15}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"what": 0, "reinforc": [0, 1, 10, 11, 15], "learn": [0, 1, 6, 7, 8, 9, 15], "The": [0, 1, 2, 3, 4, 7, 8, 10, 11, 14], "big": 0, "pictur": 0, "A": 0, "formal": [0, 1], "definit": 0, "framework": 1, "rl": [1, 2], "process": [1, 11], "reward": [1, 15], "hypothesi": 1, "central": 1, "idea": 1, "observ": 1, "state": [1, 2, 3], "space": 1, "action": [1, 2, 3, 4, 6], "return": 1, "two": 2, "main": [2, 10, 11], "approach": 2, "solv": [2, 4], "problem": [2, 11], "polici": [2, 4, 5, 7, 10, 12, 14, 15], "pi": 2, "agent": 2, "s": 2, "brain": 2, "base": [2, 6, 12], "method": [2, 6, 10, 11], "valu": [2, 3, 4, 5, 6, 15], "function": [2, 3, 13, 14, 15], "bellman": [3, 4], "equat": [3, 4], "relat": 3, "between": 3, "v": 3, "q": [3, 7, 8, 9], "close": 3, "form": [3, 4, 10], "solut": 3, "gershgorin": 3, "circl": 3, "theorem": [3, 4, 5, 10], "optim": [4, 12, 14, 15], "contract": 4, "map": 4, "banach": 4, "fix": [4, 8], "point": 4, "an": [4, 15], "from": [4, 15], "boe": 4, "other": [4, 10], "dynam": 5, "program": 5, "evalu": [5, 15], "improv": [5, 12], "iter": 5, "mont": [6, 10], "carlo": [6, 10], "vs": [6, 7], "tempor": 6, "differ": 6, "end": 6, "episod": [6, 10, 11], "each": 6, "step": [6, 9], "algorithm": [7, 8, 10, 15], "off": 7, "On": 7, "deep": [8, 9], "experi": [8, 15], "replai": [8, 9], "target": 8, "variant": 8, "doubl": 8, "dqn": 8, "pytorch": [9, 10, 11], "task": 9, "packag": 9, "memori": 9, "network": [9, 10], "hyperparamet": 9, "util": 9, "train": [9, 15], "one": 9, "loop": [9, 10, 11, 15], "gradient": [10, 15], "advantag": [10, 11, 13, 15], "disadvantag": 10, "don": 10, "t": 10, "let": 10, "past": 10, "distract": 10, "you": 10, "baselin": 10, "exampl": [10, 11], "env": [10, 11], "One": [10, 11], "actor": [11, 15], "critic": [11, 15], "varianc": 11, "a2c": 11, "reduc": 11, "ad": 11, "model": [11, 15], "trpo": 12, "preliminari": [12, 13], "monoton": 12, "guarante": 12, "parameter": 12, "sampl": [12, 15], "estim": [12, 13], "gener": 13, "proxim": 14, "introduc": 14, "clip": 14, "surrog": 14, "object": 14, "recap": 14, "ratio": 14, "unclip": 14, "part": 14, "ppo": [14, 15], "human": 15, "feedback": 15, "introduct": 15, "trainer": 15, "how": 15, "work": 15, "expect": 15, "dataset": 15, "format": 15, "us": 15, "ppotrain": 15, "initi": 15, "start": 15, "dive": 15, "1": 15, "rollout": 15, "2": 15, "3": 15, "old": 15, "logprob": 15, "4": 15, "ref": 15, "sft": 15, "5": 15, "comput": 15, "per": 15, "token": 15, "kl": 15, "penalti": 15, "6": 15, "gae": 15, "7": 15, "buffer": 15, "minibatch": 15, "8": 15, "new": 15, "9": 15, "loss": 15, "10": 15, "11": 15, "pseudocod": 15, "refer": 15}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 56}})